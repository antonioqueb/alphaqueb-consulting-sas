# Etapa de construcción
FROM node:latest AS builder

WORKDIR /app

COPY package*.json ./
COPY . .

# Instalar todas las dependencias, incluyendo las de desarrollo
RUN npm install

# Construir la aplicación
RUN npm run build

# Etapa final
FROM node:latest AS final

WORKDIR /app

COPY --from=builder /app .

# Exponer el puerto en el que la aplicación escucha
EXPOSE 3000

# Iniciar la aplicación en modo de producción
CMD ["npm", "start"]
